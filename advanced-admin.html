<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Advanced Admin Panel - Tech Nova</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&family=Playfair+Display:wght@400;700&family=Montserrat:wght@300;400;600;700&family=Open+Sans:wght@300;400;600;700&family=Lato:wght@300;400;700&family=Poppins:wght@300;400;600;700&family=Raleway:wght@300;400;600;700&family=Times+New+Roman:wght@300;400;700&family=Georgia:wght@300;400;700&family=Arial:wght@300;400;700&family=Calibri:wght@300;400;700&family=Verdana:wght@300;400;700&family=Helvetica:wght@300;400;700&family=Tahoma:wght@300;400;700&family=Trebuchet+MS:wght@300;400;700&family=Impact:wght@300;400;700&family=Courier+New:wght@300;400;700&family=Georgia+Pro:wght@300;400;700&family=Source+Sans+Pro:wght@300;400;700&family=Merriweather:wght@300;400;700&family=Lora:wght@300;400;700&family=Oswald:wght@300;400;700&family=Slabo:wght@300;400;700&family=Arvo:wght@300;400;700&family=Lobster:wght@300;400;700&family=Pacifico:wght@300;400;700&family=Dancing+Script:wght@300;400;700&family=Great+Vibes:wght@300;400;700&family=Bebas+Neue:wght@300;400;700&family=Anton:wght@300;400;700&family=Oswald:wght@300;400;700&family=Playfair+Display:wght@300;400;700&family=Roboto+Slab:wght@300;400;700&family=PT+Serif:wght@300;400;700&family=Libre+Baskerville:wght@300;400;700&family=Crimson+Text:wght@300;400;700&family=Karla:wght@300;400;700&family=Work+Sans:wght@300;400;700&family=Nunito:wght@300;400;700&family=Quicksand:wght@300;400;700&family=Rubik:wght@300;400;700&family=Space+Grotesk:wght@300;400;700&family=Manrope:wght@300;400;700&family=Inter:wght@300;400;700&family=Roboto:wght@300;400;700&family=Open+Sans:wght@300;400;700&family=Lato:wght@300;400;700&family=Montserrat:wght@300;400;700&family=Poppins:wght@300;400;700&family=Raleway:wght@300;400;700" rel="stylesheet">
    <style>
        /* Default theme (dark) */
        :root {
            --bg-primary: #0c111d;
            --bg-secondary: #161d2e;
            --bg-tertiary: #1e293b;
            --text-primary: #e2e8f0;
            --text-secondary: #a0aec0;
            --text-tertiary: #94a3b8;
            --border-color: #2d3748;
            --card-bg: #1e293b;
            --header-bg: #1e293b;
            --footer-bg: #0c111d;
            --footer-text: #e2e8f0;
            --accent-color: #dc2626;
            --accent-hover: #b91c1c;
            --accent-2: #7c3aed;
            --accent-2-hover: #6d28d9;
            --accent-3: #0891b2;
            --accent-3-hover: #0e7490;
            --accent-4: #059669;
            --accent-4-hover: #047857;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.08);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.2);
            --glass-backdrop: saturate(200%) blur(12px);
        }

        /* Light theme - Yellow Theme */
        :root[data-theme="light"] {
            --bg-primary: #fef3c7;
            --bg-secondary: #fde68a;
            --bg-tertiary: #fcd34d;
            --bg-quaternary: #fbbf24;
            --text-primary: #1e293b;
            --text-secondary: #475569;
            --text-tertiary: #64748b;
            --border-color: #f59e0b;
            --card-bg: #ffffff;
            --header-bg: #ffffff;
            --footer-bg: #1e293b;
            --footer-text: #fef3c7;
            --accent-color: #dc2626;
            --accent-hover: #b91c1c;
            --accent-2: #7c3aed;
            --accent-2-hover: #6d28d9;
            --accent-3: #0891b2;
            --accent-3-hover: #0e7490;
            --accent-4: #059669;
            --accent-4-hover: #047857;
            --shadow-color: rgba(220, 38, 38, 0.1);
            --glass-bg: rgba(254, 243, 199, 0.25);
            --glass-border: rgba(251, 191, 36, 0.18);
            --glass-shadow: 0 8px 32px 0 rgba(251, 191, 36, 0.37);
            --glass-backdrop: saturate(200%) blur(12px);
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }

        /* iOS-style Glassmorphism Classes */
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: var(--glass-backdrop);
            -webkit-backdrop-filter: var(--glass-backdrop);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        .glass-header {
            background: var(--glass-bg);
            backdrop-filter: var(--glass-backdrop);
            -webkit-backdrop-filter: var(--glass-backdrop);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        .glass-footer {
            background: var(--glass-bg);
            backdrop-filter: var(--glass-backdrop);
            -webkit-backdrop-filter: var(--glass-backdrop);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        .glass-button {
            background: var(--glass-bg);
            backdrop-filter: var(--glass-backdrop);
            -webkit-backdrop-filter: var(--glass-backdrop);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            border-radius: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .glass-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--glass-shadow), 0 0 15px rgba(255, 255, 255, 0.2);
        }

        .glass-input {
            background: var(--glass-bg);
            backdrop-filter: var(--glass-backdrop);
            -webkit-backdrop-filter: var(--glass-backdrop);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            border-radius: 12px;
            transition: all 0.3s ease;
            color: var(--text-primary);
        }

        .glass-input:focus {
            outline: none;
            box-shadow: var(--glass-shadow), 0 0 15px rgba(255, 255, 255, 0.3);
        }

        .glass-nav {
            background: var(--glass-bg);
            backdrop-filter: var(--glass-backdrop);
            -webkit-backdrop-filter: var(--glass-backdrop);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        .glass-modal {
            background: var(--glass-bg);
            backdrop-filter: var(--glass-backdrop);
            -webkit-backdrop-filter: var(--glass-backdrop);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        .glass-table {
            background: var(--glass-bg);
            backdrop-filter: var(--glass-backdrop);
            -webkit-backdrop-filter: var(--glass-backdrop);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        .glass-tab {
            background: var(--glass-bg);
            backdrop-filter: var(--glass-backdrop);
            -webkit-backdrop-filter: var(--glass-backdrop);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            border-radius: 12px 12px 0 0;
            transition: all 0.3s ease;
        }

        .glass-ribbon {
            background: var(--glass-bg);
            backdrop-filter: var(--glass-backdrop);
            -webkit-backdrop-filter: var(--glass-backdrop);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            border-radius: 12px 12px 0 0;
            transition: all 0.3s ease;
        }

        .editor-canvas {
            background-color: var(--bg-secondary);
            border: 2px dashed var(--border-color);
            min-height: 600px;
            position: relative;
            overflow: hidden;
        }

        .draggable-element {
            position: absolute;
            cursor: move;
            padding: 10px;
            border: 2px solid transparent;
            border-radius: 8px;
            transition: all 0.2s ease;
            background: var(--bg-primary);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .draggable-element:hover {
            border-color: var(--accent-color);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
        }

        .draggable-element.dragging {
            opacity: 0.5;
            border-color: var(--accent-color);
            z-index: 1000;
        }

        .draggable-element.selected {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }

        .resize-handle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--accent-color);
            border: 2px solid var(--card-bg);
            border-radius: 50%;
            cursor: nwse-resize;
            bottom: -5px;
            right: -5px;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .draggable-element:hover .resize-handle,
        .draggable-element.selected .resize-handle {
            opacity: 1;
        }

        .delete-btn {
            position: absolute;
            top: -10px;
            right: -10px;
            width: 20px;
            height: 20px;
            background: #ef4444;
            color: white;
            border: 2px solid var(--card-bg);
            border-radius: 50%;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .draggable-element.selected .delete-btn {
            display: flex;
        }

        .toolbar {
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 8px;
        }

        .tool-btn {
            padding: 8px 12px;
            border-radius: 8px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
            transform: translateY(0);
        }

        .tool-btn:hover {
            background-color: var(--bg-primary);
            border-color: var(--accent-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .tool-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 6px rgba(99, 102, 241, 0.2);
        }

        .tool-btn.active {
            background-color: var(--accent-color);
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
        }

        /* Ripple effect for buttons */
        .tool-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .tool-btn:active::before {
            width: 300px;
            height: 300px;
        }

        .font-option {
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateY(0);
        }

        .font-option:hover {
            background-color: var(--bg-primary);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        /* Admin panel button animations */
        .btn {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateY(0);
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .btn:active {
            transform: translateY(0);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        /* Primary button animations */
        .btn-primary {
            background: linear-gradient(135deg, var(--accent-color), var(--accent-hover));
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        /* Secondary button animations */
        .btn-secondary {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid var(--border-color);
            position: relative;
        }

        .btn-secondary:hover {
            border-color: var(--accent-color);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        /* Success button animations */
        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        /* Danger button animations */
        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.4);
        }

        /* Warning button animations */
        .btn-warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.4);
        }

        /* Tab button animations */
        .tab-btn {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .tab-btn:hover {
            transform: translateY(-1px);
        }

        .tab-btn.active {
            transform: translateY(-1px);
        }

        .tab-btn::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 2px;
            background: var(--accent-color);
            transform: translateX(-50%);
            transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .tab-btn.active::before {
            width: 100%;
        }

        /* Card hover animations */
        .card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateY(0);
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        /* Input field animations */
        .input-field {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .input-field:focus {
            transform: translateY(-1px);
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.2);
        }

        /* Pulse animation for important buttons */
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(99, 102, 241, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(99, 102, 241, 0);
            }
        }

        .btn-pulse {
            animation: pulse 2s infinite;
        }

        /* Bounce animation for buttons */
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% {
                transform: translateY(0);
            }
            40%, 43% {
                transform: translateY(-8px);
            }
            70% {
                transform: translateY(-4px);
            }
            90% {
                transform: translateY(-2px);
            }
        }

        .btn-bounce:hover {
            animation: bounce 1s;
        }

        /* Shake animation for error buttons */
        @keyframes shake {
            0%, 100% {
                transform: translateX(0);
            }
            10%, 30%, 50%, 70%, 90% {
                transform: translateX(-2px);
            }
            20%, 40%, 60%, 80% {
                transform: translateX(2px);
            }
        }

        .btn-shake {
            animation: shake 0.5s;
        }

        .color-picker {
            width: 40px;
            height: 40px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .color-picker:hover {
            transform: scale(1.1);
            border-color: var(--accent-color);
        }

        .element-text {
            outline: none;
            background: transparent;
            border: none;
            resize: none;
            overflow: hidden;
        }

        .element-image {
            max-width: 300px;
            max-height: 300px;
            object-fit: cover;
            border-radius: 8px;
        }

        .drop-zone {
            border: 3px dashed var(--accent-color);
            background-color: rgba(99, 102, 241, 0.1);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .fade-in {
            animation: fadeIn 0.3s ease;
        }
    </style>
    
    <style>
        /* Beautiful Button Animations */
        .word-ribbon button {
            position: relative;
            overflow: hidden;
        }
        
        .word-ribbon button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .word-ribbon button:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .word-ribbon button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .word-ribbon button:active {
            transform: translateY(0);
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }
        
        /* Tab animations */
        .ribbon-tab:hover {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%) !important;
            transform: translateY(-1px);
        }
        
        .ribbon-tab.active:hover {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%) !important;
        }
        
        /* Color button animations */
        .word-ribbon button[onclick*="applyTextColor"]:hover,
        .word-ribbon button[onclick*="applyHighlightColor"]:hover {
            transform: scale(1.1);
            z-index: 10;
        }
        
        /* Select dropdown animations */
        .word-ribbon select:hover {
            background: linear-gradient(135deg, #ffffff 0%, #ffffff 100%) !important;
            border-color: #4285f4 !important;
        }
        
        /* Group container animations */
        .word-ribbon div[style*="background: linear-gradient"]:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
            </style>
</head>
<body class="min-h-screen">
    <!-- Header -->
    <header class="glass-header bg-white border-b px-6 py-4" style="background-color: var(--bg-primary); border-color: var(--border-color);">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <svg class="w-10 h-10 flex-shrink-0" viewBox="0 0 24 24">
                    <rect x="4" y="6" width="16" height="12" rx="2" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
                    <rect x="6" y="8" width="12" height="8" rx="1" fill="#1e293b" opacity="0.9"/>
                    <circle cx="12" cy="12" r="2" fill="#dc2626"/>
                    <path d="M8 10h8M8 14h8" stroke="#fef3c7" stroke-width="1.5" opacity="0.9"/>
                    <circle cx="8" cy="4" r="1" fill="#f59e0b"/>
                    <circle cx="12" cy="4" r="1" fill="#dc2626"/>
                    <circle cx="16" cy="4" r="1" fill="#f59e0b"/>
                    <path d="M10 20l2-2 2 2" stroke="#fef3c7" stroke-width="1.5" fill="none"/>
                    <circle cx="7" cy="12" r="0.5" fill="#fef3c7" opacity="0.9"/>
                    <circle cx="17" cy="12" r="0.5" fill="#fef3c7" opacity="0.9"/>
                </svg>
                <div>
                    <h1 class="text-2xl font-bold" style="color: var(--text-primary);">Admin Panel</h1>
                    <p class="text-sm" style="color: var(--text-secondary);">Tech Nova Management</p>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <button onclick="previewPost()" class="glass-button btn btn-success px-4 py-2 rounded-lg text-sm font-medium">
                    Preview
                </button>
                <button onclick="savePost()" class="glass-button btn btn-primary px-4 py-2 rounded-lg text-sm font-medium">
                    Save Post
                </button>
                                <a href="index.html" class="glass-button btn btn-secondary px-4 py-2 rounded-lg text-sm font-medium flex items-center space-x-2">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"/>
                    </svg>
                    <span>Back to Site</span>
                </a>
                <button onclick="toggleTheme()" class="glass-button ml-4 px-3 py-2 rounded-lg text-sm font-medium">
                    <span id="theme-icon">ðŸŒ™</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-6 py-8">
        <!-- Admin Panel Tabs -->
        <div class="mb-6">
            <div class="flex space-x-1 border-b glass-nav" style="border-color: var(--border-color);">
                <button onclick="showTab('dashboard')" class="glass-button tab-btn active px-4 py-2 font-medium border-b-2 border-indigo-500 text-indigo-600">Dashboard</button>
                <button onclick="showTab('posts')" class="glass-button tab-btn px-4 py-2 font-medium hover:text-indigo-600">Posts</button>
                <button onclick="showTab('editor')" class="glass-button tab-btn px-4 py-2 font-medium hover:text-indigo-600">Blog Editor</button>
                <button onclick="showTab('suggestions')" class="glass-button tab-btn px-4 py-2 font-medium hover:text-indigo-600">ðŸ’¡ Suggestions</button>
                <button onclick="showTab('users')" class="glass-button tab-btn px-4 py-2 font-medium hover:text-indigo-600">Users</button>
                <button onclick="showTab('categories')" class="glass-button tab-btn px-4 py-2 font-medium hover:text-indigo-600">Categories</button>
                <button onclick="showTab('analytics')" class="glass-button tab-btn px-4 py-2 font-medium hover:text-indigo-600">Analytics</button>
                <button onclick="showTab('settings')" class="glass-button tab-btn px-4 py-2 font-medium hover:text-indigo-600">Settings</button>
            </div>
        </div>

        <!-- Dashboard Section -->
        <div id="dashboard-section" class="tab-content">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="glass-card card p-6 rounded-xl" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm" style="color: var(--text-secondary);">Total Posts</p>
                            <p class="text-2xl font-bold">24</p>
                        </div>
                        <div class="w-12 h-12 rounded-lg flex items-center justify-center" style="background-color: var(--accent-color);">
                            <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 1 1 0 000 2H6a2 2 0 00-2 2v6a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-1a1 1 0 100-2h1a4 4 0 014 4v6a4 4 0 01-4 4H6a4 4 0 01-4-4V7a4 4 0 014-4z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                    </div>
                </div>
                <div class="glass-card card p-6 rounded-xl" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm" style="color: var(--text-secondary);">Users</p>
                            <p class="text-2xl font-bold">156</p>
                        </div>
                        <div class="w-12 h-12 bg-green-500 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"/>
                            </svg>
                        </div>
                    </div>
                </div>
                <div class="glass-card card p-6 rounded-xl" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm" style="color: var(--text-secondary);">Categories</p>
                            <p class="text-2xl font-bold">8</p>
                        </div>
                        <div class="w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"/>
                            </svg>
                        </div>
                    </div>
                </div>
                <div class="glass-card card p-6 rounded-xl" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm" style="color: var(--text-secondary);">Page Views</p>
                            <p class="text-2xl font-bold">2.4K</p>
                        </div>
                        <div class="w-12 h-12 bg-orange-500 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M10 12a2 2 0 100-4 2 2 0 000 4z"/>
                                <path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="glass-card p-6 rounded-xl" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);">
                    <h3 class="text-lg font-semibold mb-4">Quick Actions</h3>
                    <div class="space-y-3">
                        <button onclick="showTab('categories')" class="glass-button btn btn-bounce w-full px-4 py-2 rounded-lg" style="background: linear-gradient(135deg, #a855f7, #9333ea); color: white;">Manage Categories</button>
                        <button onclick="showTab('users')" class="glass-button btn btn-success w-full px-4 py-2 rounded-lg">View Users</button>
                        <button onclick="showTab('settings')" class="glass-button btn btn-secondary w-full px-4 py-2 rounded-lg">Site Settings</button>
                    </div>
                </div>
                <div class="glass-card p-6 rounded-xl" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);">
                    <h3 class="text-lg font-semibold mb-4">Recent Activity</h3>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between py-2 border-b" style="border-color: var(--border-color);">
                            <span class="text-sm">New post created</span>
                            <span class="text-xs" style="color: var(--text-secondary);">2 hours ago</span>
                        </div>
                        <div class="flex items-center justify-between py-2 border-b" style="border-color: var(--border-color);">
                            <span class="text-sm">User registered</span>
                            <span class="text-xs" style="color: var(--text-secondary);">5 hours ago</span>
                        </div>
                        <div class="flex items-center justify-between py-2">
                            <span class="text-sm">Settings updated</span>
                            <span class="text-xs" style="color: var(--text-secondary);">1 day ago</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Posts Section -->
        <div id="posts-section" class="tab-content" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-semibold">Blog Posts</h2>
                <button onclick="showPostEditor()" class="glass-button btn btn-primary px-4 py-2 rounded-lg btn-pulse">+ Create New Post</button>
            </div>
            <div class="overflow-x-auto">
                <table class="glass-table w-full" style="background-color: var(--bg-primary); border: 1px solid var(--border-color);">
                    <thead>
                        <tr style="background-color: var(--bg-secondary);">
                            <th class="px-4 py-3 text-left">ID</th>
                            <th class="px-4 py-3 text-left">Title</th>
                            <th class="px-4 py-3 text-left">Category</th>
                            <th class="px-4 py-3 text-left">Status</th>
                            <th class="px-4 py-3 text-left">Date</th>
                            <th class="px-4 py-3 text-left">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="border-b" style="border-color: var(--border-color);">
                            <td class="px-4 py-3">#001</td>
                            <td class="px-4 py-3">Getting Started with AI Tools</td>
                            <td class="px-4 py-3">AI Tools</td>
                            <td class="px-4 py-3"><span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs">Published</span></td>
                            <td class="px-4 py-3">2024-01-20</td>
                            <td class="px-4 py-3">
                                <div class="flex space-x-2">
                                    <button class="glass-button btn btn-secondary px-3 py-1 rounded text-sm">Edit</button>
                                    <button class="glass-button btn btn-bounce px-3 py-1 rounded text-sm" style="background: linear-gradient(135deg, #a855f7, #9333ea); color: white;">Duplicate</button>
                                    <button class="glass-button btn btn-danger px-3 py-1 rounded text-sm">Delete</button>
                                </div>
                            </td>
                        </tr>
                        <tr class="border-b" style="border-color: var(--border-color);">
                            <td class="px-4 py-3">#002</td>
                            <td class="px-4 py-3">Latest Smartphone Reviews</td>
                            <td class="px-4 py-3">Reviews</td>
                            <td class="px-4 py-3"><span class="px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs">Draft</span></td>
                            <td class="px-4 py-3">2024-01-19</td>
                            <td class="px-4 py-3">
                                <div class="flex space-x-2">
                                    <button class="glass-button btn btn-secondary px-3 py-1 rounded text-sm">Edit</button>
                                    <button class="glass-button btn btn-bounce px-3 py-1 rounded text-sm" style="background: linear-gradient(135deg, #a855f7, #9333ea); color: white;">Duplicate</button>
                                    <button class="glass-button btn btn-danger px-3 py-1 rounded text-sm">Delete</button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Users Section -->
        <div id="users-section" class="tab-content" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-semibold">Users</h2>
                <button class="glass-button px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">Add User</button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="glass-card p-4 rounded-lg" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);">
                    <div class="flex items-center space-x-3 mb-3">
                        <div class="w-10 h-10 rounded-full flex items-center justify-center text-white font-bold" style="background-color: var(--accent-color);">JD</div>
                        <div>
                            <h4 class="font-semibold">John Doe</h4>
                            <p class="text-sm" style="color: var(--text-secondary);">john@example.com</p>
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <button class="glass-button px-3 py-1 bg-green-500 text-white rounded text-sm hover:bg-green-600">Approve</button>
                        <button class="glass-button px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600">Block</button>
                    </div>
                </div>
                <div class="glass-card p-4 rounded-lg" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);">
                    <div class="flex items-center space-x-3 mb-3">
                        <div class="w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center text-white font-bold">AS</div>
                        <div>
                            <h4 class="font-semibold">Alice Smith</h4>
                            <p class="text-sm" style="color: var(--text-secondary);">alice@example.com</p>
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <button class="glass-button px-3 py-1 bg-green-500 text-white rounded text-sm hover:bg-green-600">Approve</button>
                        <button class="glass-button px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600">Block</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Categories Section -->
        <div id="categories-section" class="tab-content" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-semibold">Categories</h2>
                <button class="glass-button px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600">New Category</button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="glass-card p-4 rounded-lg" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);">
                    <h3 class="font-semibold mb-2">Reviews</h3>
                    <p class="text-sm mb-3" style="color: var(--text-secondary);">12 articles</p>
                    <div class="flex space-x-2">
                        <button class="glass-button px-3 py-1 text-white rounded text-sm" style="background-color: var(--accent-color);">Edit</button>
                        <button class="glass-button px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600">Delete</button>
                    </div>
                </div>
                <div class="glass-card p-4 rounded-lg" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);">
                    <h3 class="font-semibold mb-2">AI Tools</h3>
                    <p class="text-sm mb-3" style="color: var(--text-secondary);">8 articles</p>
                    <div class="flex space-x-2">
                        <button class="glass-button px-3 py-1 text-white rounded text-sm" style="background-color: var(--accent-color);">Edit</button>
                        <button class="glass-button px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600">Delete</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Section -->
        <div id="analytics-section" class="tab-content" style="display: none;">
            <h2 class="text-xl font-semibold mb-6">Analytics</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="glass-card p-6 rounded-xl" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);">
                    <h3 class="text-lg font-semibold mb-4">Traffic Overview</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span>Page Views</span>
                            <span class="font-bold">2,456</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Unique Visitors</span>
                            <span class="font-bold">1,234</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Sessions</span>
                            <span class="font-bold">890</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Bounce Rate</span>
                            <span class="font-bold">32%</span>
                        </div>
                    </div>
                </div>
                <div class="glass-card p-6 rounded-xl" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);">
                    <h3 class="text-lg font-semibold mb-4">Quick Actions</h3>
                    <div class="space-y-3">
                        <button onclick="showTab('users')" class="glass-button w-full px-4 py-2 text-white rounded-lg" style="background-color: var(--accent-color);">View Users</button>
                        <button onclick="showTab('categories')" class="glass-button w-full px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600">Manage Categories</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Suggestions Section -->
        <div id="suggestions-section" class="tab-content" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-semibold">ðŸ’¡ User Suggestions</h2>
                <button onclick="refreshSuggestions()" class="glass-button px-4 py-2 rounded-lg">
                    ðŸ”„ Refresh
                </button>
            </div>
            
            <div class="glass-card p-6 rounded-xl" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);">
                <div id="suggestionsList" class="space-y-4">
                    <!-- Suggestions will be loaded here -->
                    <div class="text-center py-8" style="color: var(--text-secondary);">
                        <div class="mb-4">
                            <svg class="w-16 h-16 mx-auto text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <p>No suggestions yet. Users can submit suggestions from the homepage.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Section -->
        <div id="settings-section" class="tab-content" style="display: none;">
            <h2 class="text-xl font-semibold mb-6">Settings</h2>
            <div class="glass-card p-6 rounded-xl" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium mb-2">Site Title</label>
                        <input type="text" value="Tech Nova" class="glass-input input-field w-full px-4 py-2 border rounded-lg" style="border-color: var(--border-color); background-color: var(--bg-primary);">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Contact Email</label>
                        <input type="email" value="contact@technova.com" class="glass-input input-field w-full px-4 py-2 border rounded-lg" style="border-color: var(--border-color); background-color: var(--bg-primary);">
                    </div>
                </div>
                <div class="mt-4">
                    <label class="block text-sm font-medium mb-2">Site Description</label>
                    <textarea rows="4" class="glass-input input-field w-full px-4 py-2 border rounded-lg" style="border-color: var(--border-color); background-color: var(--bg-primary);">Your trusted source for technology news, gadget reviews, and innovation insights.</textarea>
                </div>
                <button onclick="saveSettings()" class="glass-button btn btn-success mt-4 px-4 py-2 rounded-lg">Save Settings</button>
            </div>
        </div>

        <!-- Blog Editor Section -->
        <div id="editor-section" class="tab-content" style="display: none;">
            <!-- Post Settings -->
            <div class="glass-card mb-6 p-6 rounded-xl" style="background-color: var(--bg-secondary); border: 1px solid var(--border-color);">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">Post Title</label>
                        <input type="text" id="postTitle" placeholder="Enter your post title" class="glass-input input-field w-full px-4 py-2 border rounded-lg" style="border-color: var(--border-color); background-color: var(--bg-primary);">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Category</label>
                        <select id="postCategory" class="glass-input input-field w-full px-4 py-2 border rounded-lg" style="border-color: var(--border-color); background-color: var(--bg-primary);">
                            <option value="reviews">Reviews</option>
                            <option value="ai-tools">AI Tools</option>
                            <option value="comparisons">Comparisons</option>
                            <option value="tech-news">Tech News</option>
                            <option value="tutorials">Tutorials</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Status</label>
                        <select id="postStatus" class="glass-input input-field w-full px-4 py-2 border rounded-lg" style="border-color: var(--border-color); background-color: var(--bg-primary);">
                            <option value="draft">Draft</option>
                            <option value="published">Published</option>
                        </select>
                    </div>
                </div>
            </div>

        <!-- Microsoft Word-like Editor -->
        <div class="editor-container rounded-xl glass-card" style="background-color: white; border: 1px solid #ccc; min-height: 600px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <!-- Word Title Bar -->
            <div class="word-title-bar glass-header" style="background: linear-gradient(to bottom, #f0f0f0, #e0e0e0); border-bottom: 1px solid #ccc; padding: 8px 15px; display: flex; justify-content: space-between; align-items: center;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <div style="width: 20px; height: 20px; background: #2b579a; border-radius: 2px;"></div>
                    <span style="font-family: 'Segoe UI', sans-serif; font-size: 12px; font-weight: 600;">Document1 - Microsoft Word</span>
                </div>
                <div style="display: flex; gap: 15px;">
                    <button onclick="minimizeWindow()" style="background: none; border: none; cursor: pointer;">ðŸ—•</button>
                    <button onclick="maximizeWindow()" style="background: none; border: none; cursor: pointer;">ðŸ—–</button>
                    <button onclick="closeWindow()" style="background: none; border: none; cursor: pointer;">âœ•</button>
                </div>
            </div>

            <!-- Word Ribbon -->
            <div class="word-ribbon glass-ribbon" style="background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%); border-bottom: 1px solid var(--border-color); box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                <!-- Ribbon Tabs -->
                <div class="ribbon-tabs glass-tab" style="display: flex; background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--border-color) 100%); border-bottom: 1px solid var(--border-color);">
                    <button class="ribbon-tab active glass-button" onclick="switchRibbonTab('home')" style="padding: 10px 20px; border: none; background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%); border-bottom: 3px solid #4285f4; cursor: pointer; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 13px; font-weight: 600; color: var(--text-primary); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); border-radius: 8px 8px 0 0; margin: 2px; box-shadow: 0 2px 8px rgba(66, 133, 244, 0.2);">HOME</button>
                    <button class="ribbon-tab glass-button" onclick="switchRibbonTab('insert')" style="padding: 10px 20px; border: none; background: transparent; cursor: pointer; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 13px; font-weight: 500; color: var(--text-primary); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); border-radius: 8px 8px 0 0; margin: 2px;">INSERT</button>
                    <button class="ribbon-tab glass-button" onclick="switchRibbonTab('design')" style="padding: 10px 20px; border: none; background: transparent; cursor: pointer; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 13px; font-weight: 500; color: var(--text-primary); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); border-radius: 8px 8px 0 0; margin: 2px;">DESIGN</button>
                    <button class="ribbon-tab glass-button" onclick="switchRibbonTab('layout')" style="padding: 10px 20px; border: none; background: transparent; cursor: pointer; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 13px; font-weight: 500; color: var(--text-primary); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); border-radius: 8px 8px 0 0; margin: 2px;">LAYOUT</button>
                </div>

                <!-- Ribbon Content -->
                <div class="ribbon-content" style="padding: 8px;">
                    <!-- Home Tab -->
                    <div id="home-ribbon" class="ribbon-panel">
                        <div style="display: flex; gap: 20px; align-items: center;">
                            <!-- Clipboard Group -->
                            <div style="border-right: 1px solid var(--border-color); padding-right: 20px; background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%); border-radius: 12px; padding: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                <div style="font-size: 11px; color: var(--text-primary); margin-bottom: 8px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Clipboard</div>
                                <div style="display: flex; gap: 4px;">
                                    <button onclick="document.execCommand('paste')" style="padding: 6px 12px; border: 1px solid var(--border-color); background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%); cursor: pointer; font-size: 12px; border-radius: 8px; font-weight: 500; color: var(--text-primary); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 2px 4px rgba(0,0,0,0.05);">ðŸ“‹ Paste</button>
                                    <button onclick="document.execCommand('cut')" style="padding: 6px 12px; border: 1px solid var(--border-color); background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%); cursor: pointer; font-size: 12px; border-radius: 8px; font-weight: 500; color: var(--text-primary); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 2px 4px rgba(0,0,0,0.05);">âœ‚ï¸ Cut</button>
                                    <button onclick="document.execCommand('copy')" style="padding: 6px 12px; border: 1px solid var(--border-color); background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%); cursor: pointer; font-size: 12px; border-radius: 8px; font-weight: 500; color: var(--text-primary); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 2px 4px rgba(0,0,0,0.05);">ðŸ“„ Copy</button>
                                </div>
                            </div>

                            <!-- Font Group -->
                            <div style="border-right: 1px solid var(--border-color); padding-right: 20px; background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%); border-radius: 12px; padding: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                <div style="font-size: 11px; color: var(--text-primary); margin-bottom: 8px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Font</div>
                                <div style="display: flex; gap: 6px; align-items: center;">
                                    <select id="wordFontFamily" onchange="formatText('fontName', this.value)" style="padding: 4px 8px; border: 1px solid var(--border-color); font-size: 11px; border-radius: 6px; background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%); color: var(--text-primary); font-weight: 500; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                        <option value="Calibri" selected>Calibri</option>
                                        <option value="Arial">Arial</option>
                                        <option value="Times New Roman">Times New Roman</option>
                                        <option value="Georgia">Georgia</option>
                                        <option value="Verdana">Verdana</option>
                                    </select>
                                    <select id="wordFontSize" onchange="formatText('fontSize', this.value)" style="padding: 4px 8px; border: 1px solid var(--border-color); font-size: 11px; width: 60px; border-radius: 6px; background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%); color: var(--text-primary); font-weight: 500; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                                        <option value="1">8</option>
                                        <option value="2">10</option>
                                        <option value="3" selected>11</option>
                                        <option value="4">12</option>
                                        <option value="5">14</option>
                                        <option value="6">16</option>
                                        <option value="7">18</option>
                                        <option value="8">20</option>
                                        <option value="9">24</option>
                                    </select>
                                </div>
                                <div style="display: flex; gap: 3px; margin-top: 6px; flex-wrap: wrap;">
                                    <button onclick="formatText('bold')" style="padding: 6px 10px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; font-weight: bold; border-radius: 6px; font-size: 13px; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">B</button>
                                    <button onclick="formatText('italic')" style="padding: 6px 10px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; font-style: italic; border-radius: 6px; font-size: 13px; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">I</button>
                                    <button onclick="formatText('underline')" style="padding: 6px 10px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; text-decoration: underline; border-radius: 6px; font-size: 13px; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">U</button>
                                    <button onclick="formatText('strikeThrough')" style="padding: 6px 10px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; text-decoration: line-through; border-radius: 6px; font-size: 13px; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">S</button>
                                </div>
                                <div style="display: flex; gap: 6px; margin-top: 6px; align-items: center;">
                                    <!-- Text Color Picker -->
                                    <div style="display: flex; gap: 3px; align-items: center;">
                                        <input type="color" id="wordTextColor" onchange="formatText('foreColor', this.value)" value="#000000" style="width: 24px; height: 24px; border: 2px solid #dee2e6; cursor: pointer; border-radius: 6px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);" title="Text Color">
                                        <div style="display: flex; gap: 2px;">
                                            <button onclick="applyTextColor('#FF0000')" style="width: 18px; height: 18px; border: 1px solid #dee2e6; background: #FF0000; cursor: pointer; border-radius: 4px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(255,0,0,0.2);" title="Red"></button>
                                            <button onclick="applyTextColor('#00FF00')" style="width: 18px; height: 18px; border: 1px solid #dee2e6; background: #00FF00; cursor: pointer; border-radius: 4px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,255,0,0.2);" title="Green"></button>
                                            <button onclick="applyTextColor('#0000FF')" style="width: 18px; height: 18px; border: 1px solid #dee2e6; background: #0000FF; cursor: pointer; border-radius: 4px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,255,0.2);" title="Blue"></button>
                                            <button onclick="applyTextColor('#FFFF00')" style="width: 18px; height: 18px; border: 1px solid #dee2e6; background: #FFFF00; cursor: pointer; border-radius: 4px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(255,255,0,0.2);" title="Yellow"></button>
                                            <button onclick="applyTextColor('#FF00FF')" style="width: 18px; height: 18px; border: 1px solid #dee2e6; background: #FF00FF; cursor: pointer; border-radius: 4px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(255,0,255,0.2);" title="Magenta"></button>
                                            <button onclick="applyTextColor('#800080')" style="width: 18px; height: 18px; border: 1px solid #dee2e6; background: #800080; cursor: pointer; border-radius: 4px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(128,0,128,0.2);" title="Purple"></button>
                                        </div>
                                    </div>
                                </div>
                                <div style="display: flex; gap: 6px; margin-top: 6px; align-items: center;">
                                    <!-- Highlight Color Picker -->
                                    <div style="display: flex; gap: 3px; align-items: center;">
                                        <input type="color" id="wordBgColor" onchange="formatText('hiliteColor', this.value)" value="#ffff00" style="width: 24px; height: 24px; border: 2px solid #dee2e6; cursor: pointer; border-radius: 6px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);" title="Highlight Color">
                                        <div style="display: flex; gap: 2px;">
                                            <button onclick="applyHighlightColor('#FFFF00')" style="width: 18px; height: 18px; border: 1px solid #dee2e6; background: #FFFF00; cursor: pointer; border-radius: 4px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(255,255,0,0.2);" title="Yellow"></button>
                                            <button onclick="applyHighlightColor('#00FFFF')" style="width: 18px; height: 18px; border: 1px solid #dee2e6; background: #00FFFF; cursor: pointer; border-radius: 4px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,255,255,0.2);" title="Cyan"></button>
                                            <button onclick="applyHighlightColor('#FF00FF')" style="width: 18px; height: 18px; border: 1px solid #dee2e6; background: #FF00FF; cursor: pointer; border-radius: 4px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(255,0,255,0.2);" title="Magenta"></button>
                                            <button onclick="applyHighlightColor('#00FF00')" style="width: 18px; height: 18px; border: 1px solid #dee2e6; background: #00FF00; cursor: pointer; border-radius: 4px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,255,0,0.2);" title="Lime"></button>
                                            <button onclick="applyHighlightColor('#FFE4B5')" style="width: 18px; height: 18px; border: 1px solid #dee2e6; background: #FFE4B5; cursor: pointer; border-radius: 4px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(255,228,181,0.2);" title="Light Blue"></button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Paragraph Group -->
                            <div style="border-right: 1px solid #e0e0e0; padding-right: 20px; background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%); border-radius: 12px; padding: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                <div style="font-size: 11px; color: #495057; margin-bottom: 8px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Paragraph</div>
                                <div style="display: flex; gap: 3px;">
                                    <button onclick="formatText('insertUnorderedList')" style="padding: 6px 10px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; font-size: 12px; border-radius: 6px; font-weight: 500; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">â€¢â€¢</button>
                                    <button onclick="formatText('insertOrderedList')" style="padding: 6px 10px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; font-size: 12px; border-radius: 6px; font-weight: 500; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">1.</button>
                                    <button onclick="formatText('outdent')" style="padding: 6px 10px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; font-size: 12px; border-radius: 6px; font-weight: 500; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">â¬…ï¸</button>
                                    <button onclick="formatText('indent')" style="padding: 6px 10px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; font-size: 12px; border-radius: 6px; font-weight: 500; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">âž¡ï¸</button>
                                </div>
                                <div style="display: flex; gap: 3px; margin-top: 4px;">
                                    <button onclick="formatText('justifyLeft')" style="padding: 6px 10px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; font-size: 12px; border-radius: 6px; font-weight: 500; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">â¬…ï¸</button>
                                    <button onclick="formatText('justifyCenter')" style="padding: 6px 10px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; font-size: 12px; border-radius: 6px; font-weight: 500; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">â¬†ï¸</button>
                                    <button onclick="formatText('justifyRight')" style="padding: 6px 10px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; font-size: 12px; border-radius: 6px; font-weight: 500; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">âž¡ï¸</button>
                                    <button onclick="formatText('justifyFull')" style="padding: 6px 10px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; font-size: 12px; border-radius: 6px; font-weight: 500; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">â¬Œï¸</button>
                                </div>
                            </div>

                            <!-- Styles Group -->
                            <div style="background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%); border-radius: 12px; padding: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                <div style="font-size: 11px; color: #495057; margin-bottom: 8px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Styles</div>
                                <div style="display: flex; flex-direction: column; gap: 3px;">
                                    <button onclick="applyStyle('Normal')" style="padding: 6px 12px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; font-size: 12px; text-align: left; border-radius: 6px; font-weight: 500; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">Normal</button>
                                    <button onclick="applyStyle('Heading 1')" style="padding: 6px 12px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; font-size: 14px; font-weight: bold; text-align: left; border-radius: 6px; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">Heading 1</button>
                                    <button onclick="applyStyle('Heading 2')" style="padding: 6px 12px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; font-size: 12px; font-weight: bold; text-align: left; border-radius: 6px; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">Heading 2</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Insert Tab (Hidden by default) -->
                    <div id="insert-ribbon" class="ribbon-panel" style="display: none;">
                        <div style="display: flex; gap: 20px; align-items: center;">
                            <div style="background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%); border-radius: 12px; padding: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                <div style="font-size: 11px; color: #495057; margin-bottom: 8px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Pages</div>
                                <button onclick="insertPageBreak()" style="padding: 8px 16px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; font-size: 12px; border-radius: 8px; font-weight: 500; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 2px 4px rgba(0,0,0,0.05);">ðŸ“„ Page Break</button>
                            </div>
                            <div style="background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%); border-radius: 12px; padding: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                <div style="font-size: 11px; color: #495057; margin-bottom: 8px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Tables</div>
                                <button onclick="insertTable()" style="padding: 8px 16px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; font-size: 12px; border-radius: 8px; font-weight: 500; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 2px 4px rgba(0,0,0,0.05);">ðŸ“Š Table</button>
                            </div>
                            <div style="background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%); border-radius: 12px; padding: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                <div style="font-size: 11px; color: #495057; margin-bottom: 8px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Illustrations</div>
                                <div style="display: flex; flex-direction: column; gap: 3px;">
                                    <button onclick="insertOnlineImage()" style="padding: 8px 16px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); cursor: pointer; font-size: 12px; border-radius: 8px; font-weight: 600; color: #1565c0; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 2px 4px rgba(21,101,192,0.2);">ðŸŒ Insert Image from URL</button>
                                </div>
                            </div>
                            <div style="background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%); border-radius: 12px; padding: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                                <div style="font-size: 11px; color: #495057; margin-bottom: 8px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Links</div>
                                <button onclick="insertLink()" style="padding: 8px 16px; border: 1px solid #dee2e6; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); cursor: pointer; font-size: 12px; border-radius: 8px; font-weight: 500; color: #495057; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 2px 4px rgba(0,0,0,0.05);">ðŸ”— Link</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ruler -->
            <div class="word-ruler" style="height: 25px; background: linear-gradient(to right, #f8f8f8 95%, #e8e8e8 100%); border-bottom: 1px solid #ccc; position: relative; display: flex; align-items: center;">
                <div style="position: absolute; left: 50px; top: 0; font-size: 9px; color: #666; font-family: 'Segoe UI', sans-serif;">1"</div>
                <div style="position: absolute; left: 100px; top: 0; font-size: 9px; color: #666; font-family: 'Segoe UI', sans-serif;">2"</div>
                <div style="position: absolute; left: 150px; top: 0; font-size: 9px; color: #666; font-family: 'Segoe UI', sans-serif;">3"</div>
                <div style="position: absolute; left: 200px; top: 0; font-size: 9px; color: #666; font-family: 'Segoe UI', sans-serif;">4"</div>
                <div style="position: absolute; left: 250px; top: 0; font-size: 9px; color: #666; font-family: 'Segoe UI', sans-serif;">5"</div>
                <div style="position: absolute; left: 300px; top: 0; font-size: 9px; color: #666; font-family: 'Segoe UI', sans-serif;">6"</div>
                <div style="position: absolute; left: 350px; top: 0; font-size: 9px; color: #666; font-family: 'Segoe UI', sans-serif;">7"</div>
                <div style="position: absolute; left: 400px; top: 0; font-size: 9px; color: #666; font-family: 'Segoe UI', sans-serif;">8"</div>
                <!-- Indent Markers -->
                <div style="position: absolute; left: 25px; top: 5px; width: 8px; height: 8px; background: #666; border-radius: 50%;"></div>
                <div style="position: absolute; left: 50px; top: 5px; width: 8px; height: 8px; background: #666; border-radius: 50%;"></div>
            </div>
            
            <!-- Main Editor Area -->
            <div contenteditable="true" id="wordEditor" class="word-editor" style="min-height: 450px; padding: 72px 100px; font-family: 'Calibri', 'Times New Roman', serif; font-size: 11pt; line-height: 1.8; outline: none; color: var(--text-primary); background: var(--bg-primary); margin: 20px; border: 1px solid var(--border-color); box-shadow: 0 0 10px rgba(0,0,0,0.1); text-align: left;" onclick="this.focus()">
                <p>This is a sample paragraph to demonstrate proper text formatting. The editor now has improved line spacing and text alignment for better readability.</p>
                <p>Start typing your content here. The text will appear with proper formatting including:</p>
                <ul style="margin-left: 20px;">
                    <li>Proper line spacing (1.8)</li>
                    <li>Left-aligned text</li>
                    <li>Professional typography</li>
                    <li>Clear paragraph separation</li>
                </ul>
                <p><br></p>
            </div>

            <!-- Status Bar -->
            <div class="word-status-bar" style="background: var(--bg-secondary); border-top: 1px solid var(--border-color); padding: 4px 15px; display: flex; justify-content: space-between; font-family: 'Segoe UI', sans-serif; font-size: 11px; color: var(--text-primary);">
                <div>Page 1 of 1</div>
                <div>Section 1</div>
                <div>1/1</div>
                <div>Words: 0</div>
            </div>
        </div>

        <!-- Hidden file inputs removed - using online image insertion only -->

        <!-- Preview Modal -->
        <div id="previewModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
            <div class="bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto" style="background-color: var(--bg-primary);">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold">Post Preview</h3>
                        <button onclick="closePreview()" class="text-gray-500 hover:text-gray-700">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                            </svg>
                        </button>
                    </div>
                    <div id="previewContent" class="min-h-[400px] p-6 rounded-lg" style="background-color: var(--bg-secondary);">
                        <!-- Preview content will be inserted here -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        let selectedElement = null;
        let isDragging = false;
        let isResizing = false;
        let dragOffset = { x: 0, y: 0 };
        let elementCounter = 0;
        let elements = [];

        
        // Suggestions Management Functions
        function refreshSuggestions() {
            const suggestionsList = document.getElementById('suggestionsList');
            const suggestions = JSON.parse(localStorage.getItem('suggestions') || '[]');
            
            if (suggestions.length === 0) {
                suggestionsList.innerHTML = `
                    <div class="text-center py-8" style="color: var(--text-secondary);">
                        <div class="mb-4">
                            <svg class="w-16 h-16 mx-auto text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <p>No suggestions yet. Users can submit suggestions from the homepage.</p>
                    </div>
                `;
                return;
            }
            
            suggestionsList.innerHTML = suggestions.map(suggestion => `
                <div class="border rounded-lg p-4" style="border-color: var(--border-color); background-color: var(--bg-primary);">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex-1">
                            <div class="flex items-center space-x-3 mb-2">
                                <span class="font-semibold" style="color: var(--text-primary);">${suggestion.name}</span>
                                <span class="px-2 py-1 text-xs rounded-full text-white" style="background-color: var(--accent-color);">
                                    ${suggestion.type.charAt(0).toUpperCase() + suggestion.type.slice(1)}
                                </span>
                                <span class="text-xs" style="color: var(--text-secondary);">
                                    ${new Date(suggestion.timestamp).toLocaleDateString()}
                                </span>
                            </div>
                            ${suggestion.email ? `<div class="text-sm" style="color: var(--text-secondary);">${suggestion.email}</div>` : ''}
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="markSuggestionAsRead(${suggestion.id})" class="px-3 py-1 text-xs bg-green-500 text-white rounded hover:bg-green-600">
                                âœ“ Read
                            </button>
                            <button onclick="deleteSuggestion(${suggestion.id})" class="px-3 py-1 text-xs bg-red-500 text-white rounded hover:bg-red-600">
                                ðŸ—‘ï¸ Delete
                            </button>
                        </div>
                    </div>
                    <div class="mt-3" style="color: var(--text-primary);">${suggestion.message}</div>
                </div>
            `).join('');
        }
        
        function markSuggestionAsRead(id) {
            let suggestions = JSON.parse(localStorage.getItem('suggestions') || '[]');
            const suggestion = suggestions.find(s => s.id === id);
            if (suggestion) {
                suggestion.status = 'read';
                localStorage.setItem('suggestions', JSON.stringify(suggestions));
                refreshSuggestions();
                showNotification('âœ… Suggestion marked as read', 'success');
            }
        }
        
        function deleteSuggestion(id) {
            if (confirm('Are you sure you want to delete this suggestion?')) {
                let suggestions = JSON.parse(localStorage.getItem('suggestions') || '[]');
                suggestions = suggestions.filter(s => s.id !== id);
                localStorage.setItem('suggestions', JSON.stringify(suggestions));
                refreshSuggestions();
                showNotification('ðŸ—‘ï¸ Suggestion deleted', 'success');
            }
        }
        
        // Microsoft Word-like Functions - Writing Section Only

        // Test function to verify color functionality
        function testColorFunction() {
            console.log('Testing color functions...');
            const editor = document.getElementById('wordEditor');
            if (editor) {
                editor.focus();
                // Test with red color
                applyTextColor('#FF0000');
                console.log('Red color test completed');
            }
        }

        // Test function to trigger image upload directly
        function testImageUpload() {
            console.log('Testing image upload trigger...');
            const imageInput = document.getElementById('imageUpload');
            if (imageInput) {
                console.log('Image input found, clicking...');
                imageInput.click();
            } else {
                console.error('Image input not found!');
                showNotification('Error: Image input not found', 'error');
            }
        }

        // Handle Image Upload for Word Editor
        function handleImageUpload(event) {
            console.log('handleImageUpload called');
            const file = event.target.files[0];
            if (!file) {
                console.log('No file selected');
                return;
            }
            
            console.log('Image file selected:', file.name, file.type, file.size, 'bytes');
            
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    console.log('FileReader loaded successfully');
                    console.log('Data URL length:', e.target.result.length);
                    console.log('Data URL starts with:', e.target.result.substring(0, 50));
                    
                    try {
                        // Create a test image to verify the data URL
                        const testImg = new Image();
                        testImg.onload = function() {
                            console.log('Test image loaded successfully, dimensions:', testImg.width, 'x', testImg.height);
                            
                            // Insert the image into the editor
                            const img = `<img src="${e.target.result}" style="max-width: 100%; height: auto; margin: 10px 0; display: block;" alt="${file.name}">`;
                            document.execCommand('insertHTML', false, img);
                            
                            const editor = document.getElementById('wordEditor');
                            editor.focus();
                            updateWordCount();
                            showNotification('Image inserted successfully!', 'success');
                            
                            // Reset the file input
                            event.target.value = '';
                        };
                        
                        testImg.onerror = function() {
                            console.error('Test image failed to load');
                            showNotification('Error: Image data is invalid', 'error');
                        };
                        
                        testImg.src = e.target.result;
                        
                    } catch (error) {
                        console.error('Error inserting image:', error);
                        showNotification('Error inserting image: ' + error.message, 'error');
                    }
                };
                
                reader.onerror = function() {
                    console.error('FileReader error occurred');
                    showNotification('Error reading file', 'error');
                };
                
                reader.readAsDataURL(file);
                
            } else {
                console.log('Invalid file type:', file.type);
                showNotification('Please select a valid image file', 'error');
            }
        }
                
        // Function to properly clean up object URLs when removing elements
        function cleanupElementResources(element) {
            const img = element.querySelector('img');
            if (img && img.isObjectURL && img.src.startsWith('blob:')) {
                URL.revokeObjectURL(img.src);
            }
        }

        // Test function to add a sample image
        function addSampleImage() {
            console.log('Adding sample image test');
            const sampleImageSrc = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDIwMCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTUwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik04NSA2NkwxMDAgNzVMMTM1IDUwTDE2NSA3NUwxNTAgOTBMMTM1IDEwNUwxMDAgMTMwTDg1IDExMEw1MCA4NUw2NSA3MEw4NSA2NloiIGZpbGw9IiM5Q0EzQUYiLz4KPGNpcmNsZSBjeD0iNTAiIGN5PSI1MCIgcj0iOCIgZmlsbD0iI0Y1OTYwNiIvPgo8Y2lyY2xlIGN4PSIxNTAiIGN5PSIxMDAiIHI9IjgiIGZpbGw9IiNGNTk2MDYiLz4KPGNpcmNsZSBjeD0iMTIwIiBjeT0iNDAiIHI9IjYiIGZpbGw9IiMxMEI5ODEiLz4KPHN2Zz4K';
            addImageElement(sampleImageSrc);
        }

        // Test direct image with hardcoded URL
        function testDirectImage() {
            console.log('Testing direct image URL');
            const testImg = document.createElement('img');
            testImg.src = 'https://picsum.photos/200/150'; // External image URL
            testImg.style.width = '200px';
            testImg.style.height = 'auto';
            testImg.style.borderRadius = '8px';
            testImg.onload = function() {
                console.log('Direct image test SUCCESS');
                showNotification('Direct image test successful!', 'success');
            };
            testImg.onerror = function() {
                console.error('Direct image test FAILED');
                showNotification('Direct image test failed', 'error');
            };
            document.getElementById('editorCanvas').appendChild(testImg);
        }

        // Test simple image creation
        function testSimpleImage() {
            console.log('Testing simple image creation');
            const element = document.createElement('div');
            element.style.position = 'absolute';
            element.style.left = '150px';
            element.style.top = '150px';
            element.style.padding = '10px';
            element.style.background = '#f0f0f0';
            element.style.borderRadius = '8px';
            
            const img = document.createElement('img');
            img.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDIwMCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTUwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik04NSA2NkwxMDAgNzVMMTM1IDUwTDE2NSA3NUwxNTAgOTBMMTM1IDEwNUwxMDAgMTMwTDg1IDExMEw1MCA4NUw2NSA3MEw4NSA2NloiIGZpbGw9IiM5Q0EzQUYiLz4KPGNpcmNsZSBjeD0iNTAiIGN5PSI1MCIgcj0iOCIgZmlsbD0iI0Y1OTYwNiIvPgo8Y2lyY2xlIGN4PSIxNTAiIGN5PSIxMDAiIHI9IjgiIGZpbGw9IiNGNTk2MDYiLz4KPGNpcmNsZSBjeD0iMTIwIiBjeT0iNDAiIHI9IjYiIGZpbGw9IiMxMEI5ODEiLz4KPHN2Zz4K';
            img.style.width = '100px';
            img.style.height = '100px';
            
            element.appendChild(img);
            document.getElementById('editorCanvas').appendChild(element);
            showNotification('Simple image test successful!', 'success');
        }

        // Microsoft Word-like Functions
        function formatText(command, value = null) {
            try {
                // Ensure the editor has focus before executing command
                const editor = document.getElementById('wordEditor');
                editor.focus();
                
                // Execute the formatting command
                if (value !== null) {
                    document.execCommand(command, false, value);
                } else {
                    document.execCommand(command, false, null);
                }
                
                // Update word count
                updateWordCount();
                
                // Keep focus on editor
                setTimeout(() => {
                    editor.focus();
                }, 10);
            } catch (error) {
                console.error('Error executing command:', command, error);
                showNotification('Formatting error occurred', 'error');
            }
        }

        // Dedicated color functions for better reliability
        function applyTextColor(color) {
            try {
                const selection = window.getSelection();
                const editor = document.getElementById('wordEditor');
                editor.focus();
                
                if (selection.rangeCount > 0) {
                    const range = selection.getRangeAt(0);
                    const selectedText = range.toString();
                    
                    if (selectedText) {
                        // Apply color to selected text using span wrapper
                        const span = document.createElement('span');
                        span.style.color = color;
                        range.surroundContents(span);
                    } else {
                        // Apply color to cursor position for new text
                        const span = document.createElement('span');
                        span.style.color = color;
                        span.innerHTML = '&nbsp;';
                        range.insertNode(span);
                        range.selectNodeContents(span);
                        range.collapse(false);
                    }
                } else {
                    // Fallback to execCommand
                    document.execCommand('foreColor', false, color);
                }
                
                updateWordCount();
                setTimeout(() => {
                    editor.focus();
                }, 10);
            } catch (error) {
                console.error('Error applying text color:', error);
                // Fallback to execCommand
                try {
                    document.execCommand('foreColor', false, color);
                    updateWordCount();
                } catch (e) {
                    showNotification('Color error occurred', 'error');
                }
            }
        }

        function applyHighlightColor(color) {
            try {
                const selection = window.getSelection();
                const editor = document.getElementById('wordEditor');
                editor.focus();
                
                if (selection.rangeCount > 0) {
                    const range = selection.getRangeAt(0);
                    const selectedText = range.toString();
                    
                    if (selectedText) {
                        // Apply highlight using span wrapper
                        const span = document.createElement('span');
                        span.style.backgroundColor = color;
                        range.surroundContents(span);
                    } else {
                        // Apply highlight to cursor position for new text
                        const span = document.createElement('span');
                        span.style.backgroundColor = color;
                        span.innerHTML = '&nbsp;';
                        range.insertNode(span);
                        range.selectNodeContents(span);
                        range.collapse(false);
                    }
                } else {
                    // Fallback to execCommand
                    document.execCommand('hiliteColor', false, color);
                }
                
                updateWordCount();
                setTimeout(() => {
                    editor.focus();
                }, 10);
            } catch (error) {
                console.error('Error applying highlight color:', error);
                // Fallback to execCommand
                try {
                    document.execCommand('hiliteColor', false, color);
                    updateWordCount();
                } catch (e) {
                    showNotification('Highlight error occurred', 'error');
                }
            }
        }

        function saveDocument() {
            const content = document.getElementById('wordEditor').innerHTML;
            localStorage.setItem('wordDocument', content);
            showNotification('Document saved successfully!', 'success');
        }

        function insertTable() {
            try {
                const table = '<table border="1" style="border-collapse: collapse; width: 100%; margin: 10px 0;"><tr><td style="border: 1px solid #ccc; padding: 8px;">&nbsp;</td><td style="border: 1px solid #ccc; padding: 8px;">&nbsp;</td><td style="border: 1px solid #ccc; padding: 8px;">&nbsp;</td></tr><tr><td style="border: 1px solid #ccc; padding: 8px;">&nbsp;</td><td style="border: 1px solid #ccc; padding: 8px;">&nbsp;</td><td style="border: 1px solid #ccc; padding: 8px;">&nbsp;</td></tr><tr><td style="border: 1px solid #ccc; padding: 8px;">&nbsp;</td><td style="border: 1px solid #ccc; padding: 8px;">&nbsp;</td><td style="border: 1px solid #ccc; padding: 8px;">&nbsp;</td></tr></table>';
                document.execCommand('insertHTML', false, table);
                const editor = document.getElementById('wordEditor');
                editor.focus();
                updateWordCount();
            } catch (error) {
                console.error('Error inserting table:', error);
                showNotification('Error inserting table', 'error');
            }
        }

        function insertLink() {
            try {
                const url = prompt('Enter URL:');
                if (url) {
                    document.execCommand('createLink', false, url);
                    const editor = document.getElementById('wordEditor');
                    editor.focus();
                    updateWordCount();
                }
            } catch (error) {
                console.error('Error inserting link:', error);
                showNotification('Error inserting link', 'error');
            }
        }

        function insertOnlineImage() {
            try {
                const url = prompt('Enter image URL:');
                if (url) {
                    const img = `<img src="${url}" style="max-width: 100%; height: auto; margin: 10px 0; display: block;" alt="Inserted Image">`;
                    document.execCommand('insertHTML', false, img);
                    const editor = document.getElementById('wordEditor');
                    editor.focus();
                    updateWordCount();
                    showNotification('Online image inserted successfully!', 'success');
                }
            } catch (error) {
                console.error('Error inserting online image:', error);
                showNotification('Error inserting online image', 'error');
            }
        }

        function insertVideo() {
            try {
                document.getElementById('videoUpload').click();
            } catch (error) {
                console.error('Error opening video upload:', error);
                showNotification('Error opening video upload', 'error');
            }
        }

        function insertAudio() {
            try {
                document.getElementById('audioUpload').click();
            } catch (error) {
                console.error('Error opening audio upload:', error);
                showNotification('Error opening audio upload', 'error');
            }
        }

        function handleVideoUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (file.type.startsWith('video/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const video = `<video controls style="max-width: 100%; height: auto; margin: 10px 0; display: block;" src="${e.target.result}">Your browser does not support the video tag.</video>`;
                    document.execCommand('insertHTML', false, video);
                    const editor = document.getElementById('wordEditor');
                    editor.focus();
                    updateWordCount();
                    showNotification('Video inserted successfully!', 'success');
                };
                reader.readAsDataURL(file);
            } else {
                showNotification('Please select a valid video file', 'error');
            }
        }

        function handleAudioUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (file.type.startsWith('audio/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const audio = `<audio controls style="width: 100%; margin: 10px 0; display: block;" src="${e.target.result}">Your browser does not support the audio element.</audio>`;
                    document.execCommand('insertHTML', false, audio);
                    const editor = document.getElementById('wordEditor');
                    editor.focus();
                    updateWordCount();
                    showNotification('Audio inserted successfully!', 'success');
                };
                reader.readAsDataURL(file);
            } else {
                showNotification('Please select a valid audio file', 'error');
            }
        }

        function applyStyle(styleName) {
            try {
                const selection = window.getSelection();
                if (selection.rangeCount > 0) {
                    const range = selection.getRangeAt(0);
                    const selectedText = range.toString();
                    
                    if (selectedText) {
                        let html = '';
                        switch(styleName) {
                            case 'Normal':
                                html = `<span style="font-family: Calibri; font-size: 11pt; color: #000;">${selectedText}</span>`;
                                break;
                            case 'Heading 1':
                                html = `<h1 style="font-family: Calibri; font-size: 16pt; font-weight: bold; color: #2b579a; margin: 0;">${selectedText}</h1>`;
                                break;
                            case 'Heading 2':
                                html = `<h2 style="font-family: Calibri; font-size: 13pt; font-weight: bold; color: #4f81bd; margin: 0;">${selectedText}</h2>`;
                                break;
                        }
                        document.execCommand('insertHTML', false, html);
                        const editor = document.getElementById('wordEditor');
                        editor.focus();
                        updateWordCount();
                    }
                } else {
                    // If no text selected, apply style to current cursor position
                    const editor = document.getElementById('wordEditor');
                    editor.focus();
                    
                    switch(styleName) {
                        case 'Normal':
                            document.execCommand('formatBlock', false, 'p');
                            break;
                        case 'Heading 1':
                            document.execCommand('formatBlock', false, 'h1');
                            break;
                        case 'Heading 2':
                            document.execCommand('formatBlock', false, 'h2');
                            break;
                    }
                    updateWordCount();
                }
            } catch (error) {
                console.error('Error applying style:', error);
                showNotification('Error applying style', 'error');
            }
        }

        function switchRibbonTab(tabName) {
            // Hide all ribbon panels
            document.querySelectorAll('.ribbon-panel').forEach(panel => {
                panel.style.display = 'none';
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.ribbon-tab').forEach(tab => {
                tab.style.background = 'transparent';
                tab.style.borderBottom = 'none';
            });
            
            // Show selected ribbon panel
            const selectedPanel = document.getElementById(tabName + '-ribbon');
            if (selectedPanel) {
                selectedPanel.style.display = 'block';
            }
            
            // Add active class to selected tab
            event.target.style.background = 'white';
            event.target.style.borderBottom = '3px solid #5b9bd5';
        }

        function updateWordCount() {
            const editor = document.getElementById('wordEditor');
            const text = editor.innerText || editor.textContent || '';
            const words = text.trim().split(/\s+/).filter(word => word.length > 0).length;
            const wordCountElement = document.querySelector('.word-status-bar div:last-child');
            if (wordCountElement) {
                wordCountElement.textContent = `Words: ${words}`;
            }
        }

        function minimizeWindow() {
            showNotification('Window minimized', 'info');
        }

        function maximizeWindow() {
            showNotification('Window maximized', 'info');
        }

        function closeWindow() {
            if (confirm('Are you sure you want to close this document? Any unsaved changes will be lost.')) {
                clearWordEditor();
            }
        }

        function toggleSpellCheck() {
            const editor = document.getElementById('wordEditor');
            editor.spellcheck = !editor.spellcheck;
            showNotification(`Spell check ${editor.spellcheck ? 'enabled' : 'disabled'}`, 'info');
        }

        function findReplace() {
            const findText = prompt('Find:');
            if (findText) {
                const replaceText = prompt('Replace with:');
                if (replaceText !== null) {
                    const content = document.getElementById('wordEditor').innerHTML;
                    const newContent = content.replace(new RegExp(findText, 'g'), replaceText);
                    document.getElementById('wordEditor').innerHTML = newContent;
                    showNotification('Find and replace completed', 'success');
                    updateWordCount();
                }
            }
        }

        // Convert blob URL to data URL
        async function convertBlobToDataURL(blobUrl) {
            try {
                const response = await fetch(blobUrl);
                const blob = await response.blob();
                return new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = () => resolve(reader.result);
                    reader.readAsDataURL(blob);
                });
            } catch (error) {
                console.error('Error converting blob to data URL:', error);
                return 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDIwMCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTUwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik04NSA2NkwxMDAgNzVMMTM1IDUwTDE2NSA3NUwxNTAgOTBMMTM1IDEwNUwxMDAgMTMwTDg1IDExMEw1MCA4NUw2NSA3MEw4NSA2NloiIGZpbGw9IiM5Q0EzQUYiLz4KPGNpcmNsZSBjeD0iNTAiIGN5PSI1MCIgcj0iOCIgZmlsbD0iI0Y1OTYwNiIvPgo8Y2lyY2xlIGN4PSIxNTAiIGN5PSIxMDAiIHI9IjgiIGZpbGw9IiNGNTk2MDYiLz4KPGNpcmNsZSBjeD0iMTIwIiBjeT0iNDAiIHI9IjYiIGZpbGw9IiMxMEI5ODEiLz4KPHN2Zz4K';
            }
        }

        // Save Blog Post function
        async function saveBlogPost() {
            console.log('Saving blog post...');
            
            // Get post settings
            const postTitle = document.getElementById('postTitle')?.value || 'Untitled Post';
            const postCategory = document.getElementById('postCategory')?.value || 'reviews';
            const postStatus = document.getElementById('postStatus')?.value || 'draft';
            
            // Get content from Word-like editor
            const wordEditor = document.getElementById('wordEditor');
            let postContent = wordEditor.innerHTML;
            
            // Convert any blob URLs to data URLs in the content
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = postContent;
            const images = tempDiv.querySelectorAll('img');
            
            const imagePromises = [];
            images.forEach(img => {
                if (img.src.startsWith('blob:')) {
                    imagePromises.push(
                        convertBlobToDataURL(img.src).then(dataUrl => {
                            img.src = dataUrl;
                        })
                    );
                }
            });
            
            // Wait for all conversions to complete
            await Promise.all(imagePromises);
            
            // Get the updated content
            postContent = tempDiv.innerHTML;
            
            // Create post object
            const blogPost = {
                id: Date.now(),
                title: postTitle,
                category: postCategory,
                status: postStatus,
                content: postContent,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            // Save to localStorage
            let posts = JSON.parse(localStorage.getItem('blogPosts') || '[]');
            posts.push(blogPost);
            localStorage.setItem('blogPosts', JSON.stringify(posts));
            
            // Show success notification
            showNotification(`Blog post "${postTitle}" published successfully!`, 'success');
            
            // Clear the editor
            setTimeout(() => {
                if (confirm('Post saved successfully! Would you like to create a new post?')) {
                    clearWordEditor();
                }
            }, 1000);
            
            console.log('Blog post saved:', blogPost);
        }

        // Clear Word editor function
        function clearWordEditor() {
            const wordEditor = document.getElementById('wordEditor');
            wordEditor.innerHTML = 'Start typing your blog post here...';
            
            // Reset form fields
            if (document.getElementById('postTitle')) {
                document.getElementById('postTitle').value = '';
            }
            if (document.getElementById('postCategory')) {
                document.getElementById('postCategory').value = 'reviews';
            }
            if (document.getElementById('postStatus')) {
                document.getElementById('postStatus').value = 'draft';
            }
            
            showNotification('Editor cleared for new post', 'info');
        }

        // Create New Post function
        function createNewPost() {
            console.log('Creating new post...');
            
            // Clear all existing content
            const canvas = document.getElementById('editorCanvas');
            const elements = canvas.querySelectorAll('.draggable-element');
            elements.forEach(element => element.remove());
            
            // Reset form fields
            if (document.getElementById('postTitle')) {
                document.getElementById('postTitle').value = '';
            }
            if (document.getElementById('postCategory')) {
                document.getElementById('postCategory').value = 'reviews';
            }
            if (document.getElementById('postStatus')) {
                document.getElementById('postStatus').value = 'draft';
            }
            
            // Show editor tab
            showTab('editor');
            
            // Show notification
            showNotification('New post created! Start adding your content.', 'success');
            
            // Focus on title field
            setTimeout(() => {
                if (document.getElementById('postTitle')) {
                    document.getElementById('postTitle').focus();
                }
            }, 500);
        }

        // Clear editor function
        function clearEditor() {
            const canvas = document.getElementById('editorCanvas');
            const elements = canvas.querySelectorAll('.draggable-element');
            elements.forEach(element => element.remove());
            
            // Reset form fields
            if (document.getElementById('postTitle')) {
                document.getElementById('postTitle').value = '';
            }
            if (document.getElementById('postCategory')) {
                document.getElementById('postCategory').value = 'reviews';
            }
            
            showNotification('Editor cleared for new post', 'info');
        }

        // Add Controls to Element
        function addElementControls(element) {
            const deleteBtn = document.createElement('div');
            deleteBtn.className = 'delete-btn';
            deleteBtn.innerHTML = 'Ã—';
            deleteBtn.onclick = function(e) {
                e.stopPropagation();
                // Clean up resources before removing element
                cleanupElementResources(element);
                element.remove();
                if (selectedElement === element) {
                    selectedElement = null;
                }
            };
            element.appendChild(deleteBtn);

            const resizeHandle = document.createElement('div');
            resizeHandle.className = 'resize-handle';
            element.appendChild(resizeHandle);
        }

        // Authentication check
        function checkAuth() {
            const isAuthenticated = sessionStorage.getItem('adminAuthenticated');
            if (!isAuthenticated) {
                // Redirect to login page
                window.location.href = 'admin.html';
            }
        }

        // Save Settings function
        function saveSettings() {
            const siteTitle = document.querySelector('input[value="Tech Nova"]').value;
            const contactEmail = document.querySelector('input[type="email"]').value;
            const siteDescription = document.querySelector('textarea').value;
            
            // Save to localStorage
            localStorage.setItem('siteTitle', siteTitle);
            localStorage.setItem('contactEmail', contactEmail);
            localStorage.setItem('siteDescription', siteDescription);
            
            // Show success notification
            showNotification('Settings saved successfully!', 'success');
            
            console.log('Settings saved:', {
                title: siteTitle,
                email: contactEmail,
                description: siteDescription
            });
        }

        // Tab switching function
        function showTab(tabName) {
            // Hide all sections
            document.querySelectorAll('.tab-content').forEach(section => {
                section.style.display = 'none';
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab-btn').forEach(tab => {
                tab.classList.remove('active', 'border-b-2', 'border-indigo-500', 'text-indigo-600');
                tab.classList.add('hover:text-indigo-600');
            });
            
            // Show selected section
            document.getElementById(tabName + '-section').style.display = 'block';
            
            // Add active class to clicked tab
            const activeTab = Array.from(document.querySelectorAll('.tab-btn')).find(tab => 
                tab.textContent.toLowerCase().includes(tabName)
            );
            if (activeTab) {
                activeTab.classList.add('active', 'border-b-2', 'border-indigo-500', 'text-indigo-600');
                activeTab.classList.remove('hover:text-indigo-600');
            }
            
            // Show/hide Post Blog button based on tab
            const postBlogButton = document.getElementById('postBlogButton');
            if (postBlogButton) {
                if (tabName === 'editor') {
                    postBlogButton.style.display = 'block';
                } else {
                    postBlogButton.style.display = 'none';
                }
            }
            
            console.log('Switched to tab:', tabName);
        }

        // Show notification
        function showNotification(message, type) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 fade-in`;
            
            if (type === 'success') {
                notification.classList.add('bg-green-500', 'text-white');
            } else if (type === 'error') {
                notification.classList.add('bg-red-500', 'text-white');
            } else {
                notification.classList.add('bg-blue-500', 'text-white');
            }
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Show post editor
        function showPostEditor() {
            showTab('editor');
            showNotification('Post editor opened! Start creating your amazing content.', 'info');
            console.log('Post editor opened');
        }

        // Edit post function
        function editPost(postId) {
            showNotification(`Editing post ${postId}`, 'info');
            showPostEditor();
            console.log('Editing post:', postId);
        }

        // Duplicate post function
        function duplicatePost(postId) {
            showNotification(`Duplicated post ${postId}`, 'success');
            console.log('Duplicated post:', postId);
        }

        // Delete post function
        function deletePost(postId) {
            if (confirm(`Are you sure you want to delete post ${postId}?`)) {
                showNotification(`Deleted post ${postId}`, 'success');
                console.log('Deleted post:', postId);
            }
        }

        // Make Element Interactive
        function makeElementInteractive(element) {
            // Dragging
            element.addEventListener('mousedown', function(e) {
                if (e.target.classList.contains('resize-handle')) {
                    startResize(e, element);
                } else {
                    startDrag(e, element);
                }
            });

            // Selection
            element.addEventListener('click', function(e) {
                e.stopPropagation();
                selectElement(element);
            });

            // Text editing
            element.addEventListener('dblclick', function(e) {
                if (element.contentEditable === 'true') {
                    element.focus();
                    // Select all text
                    const range = document.createRange();
                    range.selectNodeContents(element);
                    const selection = window.getSelection();
                    selection.removeAllRanges();
                    selection.addRange(range);
                }
            });
        }

        // Start Dragging
        function startDrag(e, element) {
            isDragging = true;
            element.classList.add('dragging');
            
            const rect = element.getBoundingClientRect();
            const canvasRect = document.getElementById('editorCanvas').getBoundingClientRect();
            
            dragOffset.x = e.clientX - rect.left;
            dragOffset.y = e.clientY - rect.top;
            
            selectElement(element);
        }

        // Start Resizing
        function startResize(e, element) {
            isResizing = true;
            e.stopPropagation();
            selectElement(element);
        }

        // Mouse Move
        document.addEventListener('mousemove', function(e) {
            if (isDragging && selectedElement) {
                const canvas = document.getElementById('editorCanvas');
                const canvasRect = canvas.getBoundingClientRect();
                
                let newX = e.clientX - canvasRect.left - dragOffset.x;
                let newY = e.clientY - canvasRect.top - dragOffset.y;
                
                // Keep element within canvas bounds
                newX = Math.max(0, Math.min(newX, canvasRect.width - selectedElement.offsetWidth));
                newY = Math.max(0, Math.min(newY, canvasRect.height - selectedElement.offsetHeight));
                
                selectedElement.style.left = newX + 'px';
                selectedElement.style.top = newY + 'px';
            }
            
            if (isResizing && selectedElement) {
                const rect = selectedElement.getBoundingClientRect();
                const newWidth = e.clientX - rect.left;
                const newHeight = e.clientY - rect.top;
                
                if (newWidth > 50) selectedElement.style.width = newWidth + 'px';
                if (newHeight > 30) selectedElement.style.height = newHeight + 'px';
            }
        });

        // Mouse Up
        document.addEventListener('mouseup', function() {
            if (isDragging && selectedElement) {
                selectedElement.classList.remove('dragging');
            }
            isDragging = false;
            isResizing = false;
        });

        // Select Element
        function selectElement(element) {
            // Remove previous selection
            document.querySelectorAll('.draggable-element').forEach(el => {
                el.classList.remove('selected');
            });
            
            // Add selection to new element
            element.classList.add('selected');
            selectedElement = element;
            
            // Update toolbar values
            updateToolbarFromElement(element);
        }

        // Update Toolbar from Selected Element
        function updateToolbarFromElement(element) {
            const computedStyle = window.getComputedStyle(element);
            
            // Update font family
            const fontFamily = computedStyle.fontFamily.replace(/['"]/g, '');
            document.getElementById('fontFamily').value = fontFamily;
            
            // Update font size
            const fontSize = computedStyle.fontSize;
            document.getElementById('fontSize').value = fontSize;
            
            // Update color
            const color = rgbToHex(computedStyle.color);
            document.getElementById('textColor').value = color;
        }

        // RGB to Hex Conversion
        function rgbToHex(rgb) {
            const result = rgb.match(/\d+/g);
            if (result) {
                return "#" + ((1 << 24) + (parseInt(result[0]) << 16) + (parseInt(result[1]) << 8) + parseInt(result[2])).toString(16).slice(1);
            }
            return '#000000';
        }

        // Update Selected Element
        function updateSelectedElement() {
            if (!selectedElement) return;
            
            const fontFamily = document.getElementById('fontFamily').value;
            const fontSize = document.getElementById('fontSize').value;
            const textColor = document.getElementById('textColor').value;
            
            selectedElement.style.fontFamily = fontFamily;
            selectedElement.style.fontSize = fontSize;
            selectedElement.style.color = textColor;
        }

        // Text Formatting Functions
        function toggleBold() {
            if (!selectedElement) return;
            const currentWeight = selectedElement.style.fontWeight;
            selectedElement.style.fontWeight = currentWeight === 'bold' ? 'normal' : 'bold';
        }

        function toggleItalic() {
            if (!selectedElement) return;
            const currentStyle = selectedElement.style.fontStyle;
            selectedElement.style.fontStyle = currentStyle === 'italic' ? 'normal' : 'italic';
        }

        function toggleUnderline() {
            if (!selectedElement) return;
            const currentDecoration = selectedElement.style.textDecoration;
            selectedElement.style.textDecoration = currentDecoration === 'underline' ? 'none' : 'underline';
        }

        // Layout Functions
        function bringToFront() {
            if (!selectedElement) return;
            const maxZ = Math.max(...Array.from(document.querySelectorAll('.draggable-element')).map(el => 
                parseInt(window.getComputedStyle(el).zIndex) || 0
            ));
            selectedElement.style.zIndex = maxZ + 1;
        }

        function sendToBack() {
            if (!selectedElement) return;
            selectedElement.style.zIndex = 1;
        }

        function duplicateElement() {
            if (!selectedElement) return;
            
            const clone = selectedElement.cloneNode(true);
            clone.id = `element-${++elementCounter}`;
            clone.style.left = (parseInt(selectedElement.style.left) + 20) + 'px';
            clone.style.top = (parseInt(selectedElement.style.top) + 20) + 'px';
            clone.classList.remove('selected');
            
            // Re-add event listeners
            makeElementInteractive(clone);
            
            document.getElementById('editorCanvas').appendChild(clone);
            selectElement(clone);
        }

        function deleteSelected() {
            if (!selectedElement) return;
            selectedElement.remove();
            selectedElement = null;
        }

        // Preview Function
        function previewPost() {
            const modal = document.getElementById('previewModal');
            const content = document.getElementById('previewContent');
            const canvas = document.getElementById('editorCanvas');
            
            // Clone canvas content
            content.innerHTML = canvas.innerHTML;
            
            // Remove interactive elements from preview
            content.querySelectorAll('.delete-btn, .resize-handle').forEach(el => el.remove());
            content.querySelectorAll('.draggable-element').forEach(el => {
                el.classList.remove('draggable-element', 'selected', 'dragging');
                el.contentEditable = false;
            });
            
            modal.classList.remove('hidden');
        }

        function closePreview() {
            document.getElementById('previewModal').classList.add('hidden');
        }

        // Save Post Function
        function savePost() {
            const title = document.getElementById('postTitle').value;
            const category = document.getElementById('postCategory').value;
            const status = document.getElementById('postStatus').value;
            const canvas = document.getElementById('editorCanvas');
            
            if (!title) {
                alert('Please enter a post title');
                return;
            }
            
            // Collect all elements data
            const postData = {
                title: title,
                category: category,
                status: status,
                elements: [],
                createdAt: new Date().toISOString()
            };
            
            canvas.querySelectorAll('.draggable-element').forEach((element, index) => {
                postData.elements.push({
                    type: element.querySelector('img') ? 'image' : 'text',
                    content: element.innerHTML,
                    styles: {
                        left: element.style.left,
                        top: element.style.top,
                        width: element.style.width,
                        height: element.style.height,
                        fontSize: element.style.fontSize,
                        fontFamily: element.style.fontFamily,
                        color: element.style.color,
                        fontWeight: element.style.fontWeight,
                        fontStyle: element.style.fontStyle,
                        textDecoration: element.style.textDecoration
                    }
                });
            });
            
            // Save to localStorage (in real app, this would be sent to server)
            localStorage.setItem('blogPost_' + Date.now(), JSON.stringify(postData));
            
            alert('Post saved successfully! ðŸŽ‰');
        }

        // Click outside to deselect
        document.getElementById('editorCanvas').addEventListener('click', function(e) {
            if (e.target === this) {
                document.querySelectorAll('.draggable-element').forEach(el => {
                    el.classList.remove('selected');
                });
                selectedElement = null;
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (selectedElement) {
                switch(e.key) {
                    case 'Delete':
                    case 'Backspace':
                        if (!e.target.matches('input, textarea')) {
                            e.preventDefault();
                            deleteSelected();
                        }
                        break;
                    case 'd':
                        if (e.ctrlKey || e.metaKey) {
                            e.preventDefault();
                            duplicateElement();
                        }
                        break;
                }
            }
        });

        // Adblock Detection and Popup
        function detectAdblock() {
            // Create a test ad element that adblockers typically block
            const testAd = document.createElement('div');
            testAd.innerHTML = '&nbsp;';
            testAd.className = 'adsbox pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links';
            testAd.style.cssText = 'position: absolute; top: -10px; left: -10px; width: 1px; height: 1px; visibility: hidden;';
            
            document.body.appendChild(testAd);
            
            setTimeout(() => {
                const isBlocked = testAd.offsetHeight === 0;
                document.body.removeChild(testAd);
                
                if (isBlocked) {
                    showAdblockPopup();
                }
            }, 100);
        }
        
        function showAdblockPopup() {
            // Create popup overlay
            const overlay = document.createElement('div');
            overlay.id = 'adblock-popup';
            overlay.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 fade-in';
            overlay.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 9999;';
            
            // Create popup content
            const popup = document.createElement('div');
            popup.className = 'bg-white rounded-xl p-8 max-w-md mx-4 transform scale-100 transition-transform duration-300';
            popup.style.cssText = 'background: white; border-radius: 12px; padding: 32px; max-width: 400px; margin: 16px; transform: scale(1); transition: transform 0.3s;';
            
            popup.innerHTML = `
                <div class="text-center">
                    <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-red-500" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-2">Adblocker Detected!</h3>
                    <p class="text-gray-600 mb-6">
                        We've detected that you're using an adblocker. Please consider disabling it to support our work and ensure the best experience on our platform.
                    </p>
                    <div class="space-y-3">
                        <button onclick="disableAdblockPopup()" class="w-full px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors duration-200">
                            I've Disabled Adblocker
                        </button>
                        <button onclick="remindLater()" class="w-full px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors duration-200">
                            Remind Me Later
                        </button>
                        <button onclick="keepAdblock()" class="w-full px-4 py-2 text-gray-500 text-sm hover:text-gray-700 transition-colors duration-200">
                            Keep Adblock Enabled
                        </button>
                    </div>
                </div>
            `;
            
            overlay.appendChild(popup);
            document.body.appendChild(overlay);
            
            // Add fade-in animation
            setTimeout(() => {
                overlay.classList.add('fade-in');
            }, 10);
        }
        
        function disableAdblockPopup() {
            const popup = document.getElementById('adblock-popup');
            if (popup) {
                popup.style.opacity = '0';
                setTimeout(() => {
                    popup.remove();
                    showNotification('Thank you for supporting us! ðŸŽ‰', 'success');
                    // Re-check after 2 seconds
                    setTimeout(detectAdblock, 2000);
                }, 300);
            }
        }
        
        function remindLater() {
            const popup = document.getElementById('adblock-popup');
            if (popup) {
                popup.style.opacity = '0';
                setTimeout(() => {
                    popup.remove();
                }, 300);
            }
            // Remind after 5 minutes
            setTimeout(detectAdblock, 300000);
        }
        
        function keepAdblock() {
            const popup = document.getElementById('adblock-popup');
            if (popup) {
                popup.style.opacity = '0';
                setTimeout(() => {
                    popup.remove();
                }, 300);
            }
            // Don't show again in this session
            sessionStorage.setItem('adblock-dismissed', 'true');
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Check authentication first
            checkAuth();
            
            // Check if user has already dismissed adblock popup
            if (!sessionStorage.getItem('adblock-dismissed')) {
                // Run adblock detection after page loads
                setTimeout(detectAdblock, 1000);
            }
            
            // Initialize Word editor
            const wordEditor = document.getElementById('wordEditor');
            if (wordEditor) {
                // Add input event listener for word count
                wordEditor.addEventListener('input', updateWordCount);
                
                // Add keydown event listener for typing
                wordEditor.addEventListener('keydown', function(e) {
                    // Allow all typing
                    e.stopPropagation();
                });
                
                // Add keyup event listener for typing
                wordEditor.addEventListener('keyup', function(e) {
                    e.stopPropagation();
                    updateWordCount();
                });
                
                // Add paste event listener
                wordEditor.addEventListener('paste', function(e) {
                    e.stopPropagation();
                    setTimeout(updateWordCount, 100);
                });
                
                // Set initial content with placeholder
                wordEditor.innerHTML = '<p><br></p>';
                
                // Focus on editor after a short delay
                setTimeout(() => {
                    wordEditor.focus();
                    // Place cursor at the beginning
                    const range = document.createRange();
                    range.selectNodeContents(wordEditor);
                    range.collapse(true);
                    const selection = window.getSelection();
                    selection.removeAllRanges();
                    selection.addRange(range);
                }, 100);
                
                // Update initial word count
                updateWordCount();
            }
        });

        // Theme Toggle Function
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            const themeIcon = document.getElementById('theme-icon');
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            // Update icon
            themeIcon.textContent = newTheme === 'dark' ? 'ðŸŒ™' : 'â˜€ï¸';
        }

        // Load saved theme on page load
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            const themeIcon = document.getElementById('theme-icon');
            if (themeIcon) {
                themeIcon.textContent = savedTheme === 'dark' ? 'ðŸŒ™' : 'â˜€ï¸';
            }
        });
    </script>
<!-- Floating Action Button for Post Blog (Editor Only) -->
<div id="postBlogButton" class="fixed bottom-6 right-6 z-50" style="display: none;">
    <button onclick="saveBlogPost()" class="btn btn-primary px-6 py-3 rounded-full shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 btn-pulse" style="background: linear-gradient(135deg, #10b981, #059669); color: white; border: none;">
        <span class="flex items-center space-x-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12"></path>
            </svg>
            <span class="font-semibold">Post Blog</span>
        </span>
    </button>
</div>

</body>
</html>
